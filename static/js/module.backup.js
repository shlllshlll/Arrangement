"use strict";define(["require","common","module.utils"],function(t,i,a){function n(t,i,a,c){if(!(this instanceof n))throw TypeError("BackUp不能被用作函数调用");this.bckUrl=t,this.backupTime=i,this.backupInterval=null,this.dataCallBck=a,this.getDataCallBck=c}return n.prototype={constructor:n,sendData:function(){var t=this.dataCallBck();a.postJson({url:this.bckUrl,data:JSON.stringify(t)},function(){return i.showNotification("备份成功！","success")},function(){return i.showNotification("备份失败，请检查服务器连接！","danger")})},startBackup:function(){this.backupInterval||(this.backupInterval=setInterval(this.sendData.bind(this),1e3*this.backupTime),i.showNotification("数据备份已开启，每"+this.backupTime+"s备份一次","info"))},stopBackup:function(){clearInterval(this.backupInterval),this.backupInterval=null,i.showNotification("数据备份已关闭","info")},getData:function(){var t=this;a.getJson({url:i.backUpUrl},function(i){"String"==typeof i&&(i=JSON.parse(i)),t.getDataCallBck(i),t.startBackup()},function(){return i.showNotification("恢复失败，请检查服务器连接！","danger")})}},n});